{
  "id": "petstore_rbac_policy",
  "name": "PetStore RBAC Authorization Policy",
  "description": "Role-based access control for PetStore domain operations",
  "version": "1.0",
  "rules": [
    {
      "id": "public_pet_access",
      "description": "Public access to pet listings",
      "resource": "/api/v1/pets/public",
      "action": "GET",
      "principal": {
        "type": "*"
      },
      "effect": "allow"
    },
    {
      "id": "authenticated_pet_read",
      "description": "Authenticated users can read pet information",
      "resource": "/api/v1/pets/*",
      "action": "GET",
      "principal": {
        "roles": ["user", "admin"]
      },
      "effect": "allow"
    },
    {
      "id": "admin_pet_management",
      "description": "Admins can create, update, and delete pets",
      "resource": "/api/v1/pets/*",
      "action": ["POST", "PUT", "DELETE"],
      "principal": {
        "roles": ["admin"]
      },
      "effect": "allow"
    },
    {
      "id": "user_order_access",
      "description": "Users can read and create orders",
      "resource": "/api/v1/orders/*",
      "action": ["GET", "POST"],
      "principal": {
        "roles": ["user", "admin"]
      },
      "effect": "allow"
    },
    {
      "id": "admin_order_management",
      "description": "Admins can manage all orders",
      "resource": "/api/v1/orders/*",
      "action": ["GET", "POST", "PUT", "DELETE"],
      "principal": {
        "roles": ["admin"]
      },
      "effect": "allow"
    },
    {
      "id": "admin_only_access",
      "description": "Admin-only endpoints",
      "resource": "/api/v1/admin/*",
      "action": "*",
      "principal": {
        "roles": ["admin"]
      },
      "effect": "allow"
    },
    {
      "id": "service_internal_access",
      "description": "Service-to-service internal endpoints",
      "resource": "/api/v1/internal/*",
      "action": "*",
      "principal": {
        "type": "service"
      },
      "effect": "allow"
    },
    {
      "id": "test_endpoints",
      "description": "Security test endpoints",
      "resource": "/api/v1/test/*",
      "action": "GET",
      "principal": {
        "roles": ["user", "admin"]
      },
      "effect": "allow"
    }
  ],
  "default_effect": "deny"
}
